<?php if ( ! defined( 'FW' ) ) {
	die( 'Forbidden' );
}

class FW_Sidebar_Picker_Option_Handler implements FW_Option_Handler {

	function get_option_value( $option_id, $option, $data = array() ) {
		return fw_ext( 'sidebars' )->get_specific_preset_by_id( get_the_ID() );
	}

	function save_option_value( $option_id, $option, $value, $data = array() ) {
		$settings = FW_Request::POST( 'fw_options/' . $option_id );
		if( $settings['position'] === 'default' ) {
			$args = array(
				'slug' => false,
				'preset' => $settings['preset']
			);
			fw_ext( 'sidebars' )->delete_sidebar_preset( $args );
		} else {
			fw_ext( 'sidebars' )->save_sidebar_settings( $settings );
		}
	}
}